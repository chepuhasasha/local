<- [Содержание](../../README.md)

---

# Данные: миграции и сиды

Документ описывает, как управляются миграции и наполнение базы в текущем состоянии проекта.

## Текущее состояние

- Добавлены миграции для доменных таблиц (`users`, `auth_identity`, `auth_otp`, `auth_session`).
- Таблицы адресов по-прежнему создаются в процессе CLI импорта.
- `TypeORM` ищет миграции в `src/infrastructure/database/migrations` и `dist/infrastructure/database/migrations`.

## Как инициализировать базу

1) Запустите миграции доменных таблиц:

```bash
npm run migration:run
```

2) Затем выполните импорт адресов (создаёт таблицы и индексы для адресов):

```bash
npm run import:addresses:dev
```

Импорт сам создаёт таблицы, индексы и расширения. Подробнее см. в [Данные: импорт адресов](addresses-import.md).

## Если понадобятся миграции

1) Определите стратегию: что должно делаться импортом, а что — миграциями.
2) Добавьте миграции и скрипты их запуска в `package.json`.
3) Зафиксируйте процесс в документации.

Важно: схема адресов всё ещё живёт в коде импорта, доменные таблицы — в миграциях.
